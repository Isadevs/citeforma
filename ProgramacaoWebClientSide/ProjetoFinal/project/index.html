<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temperatura Automática - Aldeias Históricas</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        .weather-icon {
            width: 50px;
            height: auto;
        }
    </style>
</head>
<body>
    <header>
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <a class="navbar-brand" href="#">
                <img src="./castle.svg" alt="Home" class="home-icon" width="30px">
                Aldeias Históricas
            </a>
        </nav>
    </header>

    <main>
        <div class="container">
            <h2>Temperatura e Clima nas Aldeias</h2>
            <div id="weather-container" class="row">
                <!-- Os dados do clima serão inseridos dinamicamente aqui -->
            </div>
        </div>
    </main>

    <footer>
        <div style="text-align: center;">
            <p>@Isabella Muniz</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script>
        const aldeias = [
            { nome: "Linhares da Beira", localId: 1010500 },
            { nome: "Marialva", localId: 1010600 },
            { nome: "Monsanto", localId: 1010700 },
            { nome: "Castelo Rodrigo", localId: 1010800 },
            { nome: "Almeida", localId: 1010900 }
        ];

        const weatherContainer = document.getElementById('weather-container');

        async function fetchWeatherData(localId) {
            const response = await fetch(`https://api.ipma.pt/open-data/forecast/meteorology/cities/daily/${localId}.json`);
            const data = await response.json();
            return data.data.slice(0, 5); // Retorna os próximos 5 dias
        }

        function getWeatherIcon(condition) {
            if (condition.toLowerCase().includes('chuva')) {
                return './imagens/chuva.png';
            } else if (condition.toLowerCase().includes('nuvens')) {
                return './imagens/nublado.png';
            } else if (condition.toLowerCase().includes('sol')) {
                return './imagens/sol.png';
            } else {
                return './imagens/aguaceiros.png';
            }
        }

        async function loadWeather() {
            for (const aldeia of aldeias) {
                const weatherData = await fetchWeatherData(aldeia.localId);

                const aldeiaDiv = document.createElement('div');
                aldeiaDiv.className = 'col-md-4';
                aldeiaDiv.innerHTML = `<h4>${aldeia.nome}</h4>`;

                weatherData.forEach(day => {
                    const date = new Date(day.forecastDate).toLocaleDateString('pt-PT');
                    const icon = getWeatherIcon(day.precipitaProb > 50 ? 'Chuva' : day.predWindDir);
                    aldeiaDiv.innerHTML += `
                        <p>${date}: ${day.tMin}°C - ${day.tMax}°C</p>
                        <img src="${icon}" alt="Condição Climática" class="weather-icon">
                    `;
                });

                weatherContainer.appendChild(aldeiaDiv);
            }
        }

        // Carrega o clima ao carregar a página
        loadWeather();
    </script>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
